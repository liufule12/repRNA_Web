{% extends "base.html" %}
{% block navbar %}
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
        <ul class="nav navbar-nav">
            <li><a href="{{ url_for('server') }}">Server</a></li>
            <li><a href="{{ url_for('tutorial') }}">Tutorial</a></li>
            <li><a href="{{ url_for('download') }}">Download</a></li>
            <li><a href="{{ url_for('citation') }}">Citation</a></li>
            <li><a href="{{ url_for('contact') }}">Contact us</a></li>
        </ul>
    </div><!-- /.navbar-collapse -->
{% endblock %}

{% block content %}
    <!-- Error page. -->
    {% if er_info[0] == True %}
        <div class="alert alert-danger alert-dismissible fade in" role="alert">
            <h4>Oh snap! You got an error!</h4>
            <p>{{ er_info[1] }}</p>
            <p>
                <button type="button" class="btn btn-danger" onclick="javascript: window.history.back()">Back</button>
            </p>
        </div>
    <!-- Result page. -->
    {% else %}
        <div class="alert alert-success alert-dismissible fade in" role="alert">
            <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">×</span></button>
            <p><strong>Congratulation!</strong> The parameter summary and results are as follows. &nbsp;&nbsp;&nbsp;<button type="button" class="btn btn-default" onclick="javascript: window.history.back()">Back</button></p>
        </div>

        <!-- Parameter summary -->
        <div class="panel panel-primary">
            <div class="panel-heading">
                <h4 class="panel-title">
                    <a data-toggle="collapse" href="#collapseSum" aria-expanded="true" aria-controls="collapseSum"><span class="glyphicon glyphicon-list"></span> Parameter summary</a>
                </h4>
            </div>

            <div id="collapseSum" class="panel-collapse collapse in">
                <div class="panel-body">
                    <div class="col-sm-12">
                        <div class="row">
                            <label class="col-sm-2 text-left"><i>Mode</i> :</label>
                            <p class="col-sm-2">{{ mode }}</p>
                        </div>

                        {% if mode == 'Kmer' %}
                            <div class="row">
                                <label class="col-sm-2"><i>k</i> :</label>
                                <p class="col-sm-2">{{ args['k'] }}</p>
                            </div>
                        {% endif %}

                        {% if mode == 'PseSSC' %}
                            <div class="row">
                                <label class="col-sm-2"><i>n</i> :</label>
                                <p class="col-sm-2">{{ args['n'] }}</p>
                            </div>
                        {% endif %}

                        {% if mode == 'PseDPC' %}
                            <div class="row">
                                <label class="col-sm-2"><i>d</i> :</label>
                                <p class="col-sm-2">{{ args['d'] }}</p>
                            </div>
                        {% endif %}

                        {% if 'lamada' in args %}
                            <div class="row">
                                <label class="col-sm-2"><i>λ</i> :</label>
                                <p class="col-sm-2">{{ args['lamada'] }}</p>
                            </div>
                        {% endif %}

                        {% if 'w' in args %}
                            <div class="row">
                                <label class="col-sm-2"><i>w</i> :</label>
                                <p class="col-sm-2">{{ args['w'] }}</p>
                            </div>
                        {% endif %}

                        {% if args['props'] != [] %}
                            <div class="row">
                                <label class="col-sm-2 text-left"><em>Physicochemical properties</em> :</label>
                                <div class="col-sm-10">
                                    <table class="table table-bordered table-responsive">
                                        <tr>
                                            {% for prop in args['props'] %}
                                                {% if loop.index0 % 5 == 0 %}
                                                    </tr>
                                                    <tr>
                                                {% endif %}
                                                <td>{{ prop }}</td>
                                            {% endfor %}
                                        </tr>
                                    </table>
                                </div>
                            </div>
                        {% endif %}

                        {% if args['ext_ind'] != [] %}
                            <div class="row">
                                <label class="col-sm-2 text-left"><em>User-defined indices</em> :</label>
                                <div class="col-sm-10">
                                    <table class="table table-bordered table-responsive">
                                        <tr>
                                            {% for ind in args['ext_ind'] %}
                                                {% if loop.index0 % 5 == 0 %}
                                                    </tr>
                                                    <tr>
                                                {% endif %}
                                                <td>{{ ind }}</td>
                                            {% endfor %}
                                        </tr>
                                    </table>
                                </div>
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>

        <!-- Result -->
        <div class="panel panel-primary">
            <div class="panel-heading">
                <h4 class="panel-title">
                    <a data-toggle="collapse" href="#collapseRes" aria-expanded="true" aria-controls="collapseRes"><span class="glyphicon glyphicon-list"></span> Results</a>
                     &nbsp;&nbsp;&nbsp;<a href="{{ url_for('static', filename=write_file) }}" target="_blank"><span class="glyphicon glyphicon-download-alt"></span></a>
                </h4>
            </div>

            <div id="collapseRes" class="panel-collapse collapse in">
                <div class="panel-body">
                    <p><strong>Note</strong>: The black numbers represent the values of the sequence compositions (i.e. amino acid, nucleotide, dinucleotide, or trinucleotide, etc), while the red numbers represent the values of sequence order correlation.</p>
                    <a href="javascript: window.history.back()">Continue</a>
                </div>
            </div>

            <table class="table-responsive table-bordered">
                {% for vec in res %}
                    <tr>
                        <td>><strong>{{ names[loop.index0] }}</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<button onClick="window.open('http://219.223.244.143:5000/visual/{{ user_ip_time }}/{{ loop.index0 }}','','height=2000,width=2000,scrollbars=yes,status=yes')">Visualization</button></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>
                            <table style="margin:0 auto; width:885px; line-height:25px;">
                                <tr>
                                    {% for _res in vec %}
                                        {% if loop.index0 % 10 == 0 and loop.index0 != 0 %}
                                            </tr>
                                            <tr>
                                        {% endif %}
                                        {% if 'lamada' in args %}
                                            {% if  method == 'PseDNC' or method == 'PseKNC' or method == 'PC-PseDNC-General' or method == 'SC-PseDNC-General' or method == 'PC-PseTNC-General' or method == 'SC-PseTNC-General' %}
                                                {% if loop.index0 >= 4 ** args['k'] %}
                                                    <td width="50px" style="color: #ff0000"><strong>{{ _res }}</strong></td>
                                                {% else %}
                                                    <td width="50px">{{ _res }}</td>
                                                {% endif %}
                                            {% elif method == 'PC-PseAAC' or method == 'SC-PseAAC' or method == 'PC-PseAAC-General' or method == 'SC-PseAAC-General' %}
                                                {% if loop.index0 >= 20 ** args['k'] %}
                                                    <td width="50px" style="color: #ff0000"><strong>{{ _res }}</strong></td>
                                                {% else %}
                                                    <td width="50px">{{ _res }}</td>
                                                {% endif %}
                                            {% endif %}
                                        {% else %}
                                            <td width="10%">{{ _res }}</td>
                                        {% endif %}
                                    {% endfor %}
                                </tr>
                            </table>
                        </td>
                    </tr>
                {% endfor %}
            </table>
        </div>
    {% endif %}
{% endblock %}